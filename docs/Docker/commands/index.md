# Справочник по Docker

---

## Инструкции Dockerfile

```dockerfile
FROM <image>
```

| Инструкция  | Описание                                      |
|-------------|-----------------------------------------------|
| FROM        | Базовый образ (например, `ubuntu:20.04`)      |

```dockerfile
RUN <command>
```

| Инструкция | Описание                              |
|------------|---------------------------------------|
| RUN        | Выполнить команду при сборке образа   |

```dockerfile
COPY <src> <dest>
```

| Инструкция | Описание                                        |
|------------|-------------------------------------------------|
| COPY       | Скопировать файлы/папки в образ                 |

```dockerfile
ADD <src> <dest>
```

| Инструкция | Описание                                                                  |
|------------|---------------------------------------------------------------------------|
| ADD        | Как `COPY`, но поддерживает URL и распаковку архивов                       |

```dockerfile
WORKDIR <path>
```

| Инструкция | Описание                                       |
|------------|------------------------------------------------|
| WORKDIR    | Рабочая директория внутри контейнера           |

```dockerfile
ENV <key> <value>
```

| Инструкция | Описание                        |
|------------|---------------------------------|
| ENV        | Установить переменную окружения |

```dockerfile
EXPOSE <port>
```

| Инструкция | Описание                                  |
|------------|-------------------------------------------|
| EXPOSE     | Документирует порты, которые слушает сервис |

```dockerfile
CMD ["executable", "param1", "param2"]
```

| Инструкция | Описание                                                                 |
|------------|--------------------------------------------------------------------------|
| CMD        | Команда по умолчанию (запускается при `docker run`)                      |
| Форматы    | `CMD ["prog", "arg1"]` (exec form, предпочтительнее), или `CMD prog arg` |

```dockerfile
ENTRYPOINT ["executable", "param1"]
```

| Инструкция | Описание                                                                 |
|------------|--------------------------------------------------------------------------|
| ENTRYPOINT | Определяет точку входа (нельзя переопределить так легко, как `CMD`)      |

```dockerfile
VOLUME ["/data"]
```

| Инструкция | Описание                               |
|------------|----------------------------------------|
| VOLUME     | Объявить точку монтирования тома       |

```dockerfile
USER <user>
```

| Инструкция | Описание                                |
|------------|-----------------------------------------|
| USER       | Запускать процессы от имени пользователя |

```dockerfile
ARG <name>=<default>
```

| Инструкция | Описание                                    |
|------------|---------------------------------------------|
| ARG        | Аргументы сборки, доступны только на этапе build |

```dockerfile
HEALTHCHECK --interval=30s --timeout=10s \
  CMD curl -f http://localhost/ || exit 1
```

| Инструкция   | Описание                                       |
|--------------|------------------------------------------------|
| HEALTHCHECK  | Проверка состояния контейнера                  |

---

## Пример простого Dockerfile

```dockerfile
# Базовый образ
FROM python:3.11-slim

# Рабочая директория
WORKDIR /app

# Скопировать зависимости
COPY requirements.txt .

# Установить зависимости
RUN pip install --no-cache-dir -r requirements.txt

# Скопировать код
COPY . .

# Задать переменную окружения
ENV PORT=5000

# Документируем порт
EXPOSE 5000

# Команда запуска
CMD ["python", "app.py"]
```

---
